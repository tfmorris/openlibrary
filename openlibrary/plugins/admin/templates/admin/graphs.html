
$var title: Performance Graphs

<div id="contentHead">
    $:render_template("admin/menu")
    <h1>Performance Graphs</h1>
</div>

$ grahite_base = get_graphite_base_url()

$def render_graph(target, days, **kw):
    $ defaults = {"width": 850, "height": 303, "from": days, "yMin": 0}
    $ q = urlencode(dict(defaults, target=target, **kw), doseq=True)
    <img src="$grahite_base/render/?$:q"/>

$def render_graph_page(days):
    <h2>Numbe of Hits</h2>
    $:render_graph("alias(movingAverage(stats.timers.ol.total.count, 20), '#hits')", days)
    <h2>Page Load Time</h2>

    $ names = ["alias(movingAverage(stats.timers.ol.pageload.%s.mean, 20), '%s')" % (name, name) for name in ["all", "authors", "books", "works", "home", "search", "subjects"]]
    $:render_graph(names, days, yLimit=100)

    <h2>Infobase Mean</h2>
    $:render_graph("alias(movingAverage(stats.timers.ol.infobase.mean, 20), 'infobase.mean')", days, yLimit=300)

<div id="contentBody">
<div class="tabs">
    <ul>
        <li><a href="#day" id="link_day">$_("Today")</a></li>
        <li><a href="#week" id="link_week">$_("This Week")</a></li>
        <li><a href="#month" id="link_month">$("This Month")</a></li>
    </ul>
    <div id="day">$:render_graph_page("-1days")</div>
    <div id="week">$:render_graph_page("-7days")</div>
    <div id="month">$:render_graph_page("-30days")</div>
</div>

</div>
