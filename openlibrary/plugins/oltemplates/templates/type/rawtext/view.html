$def with (page)

$var title: $page.title

$ format = query_param('format')
$if format == 'raw':
    $var content_type: $page.content_type
    $var rawtext: $:page.body
$else:
    <div id="header" style="padding-left: 24px;">
        <div id="title">$page.title</div>
        <div class="statement" style="padding-left: 6px;">
            <a href="$page.key?format=raw">View as rawtext</a>
            $if page.key.endswith(".css"):
                | <a href="#" onclick="document.location.href='http://jigsaw.w3.org/css-validator/validator?uri=' + escape(document.location.href.replace('#', '') + '?format=raw');">Validate CSS</a>
        </div>
    </div>
    <hr />

$:macros.DisplayCode(page.body)