$def with (a, b)

$var title: $_("Differences of %(title)s", title=a.key)

$add_stylesheet('/user/webchick/css/diff.css?format=raw')

    <div id="contentHead">
        <div class="head">
            <span class="tools">$_("Currently viewing differences for"):</span>
            <h1>$a.key</h1>
        </div>
    </div>


    <div id="contentBody">

    <table class="sidebyside" summary="$_('Differences')">
       <colgroup class="l">
           <col class="lineno" />
           <col class="content" />
       </colgroup>
       <colgroup class="r">
           <col class="lineno" />
           <col class="content" />
       </colgroup>
       <thead>
           <tr> 
              <th class="diff-header-top">&nbsp;</th>
              <th class="diff-header-top">$_("Revision") $a.revision</th> 
              <th class="diff-header-top">$_("Revision") $b.revision</th>
           </tr>
        </thead>
	
        $for p in set(a.keys() + b.keys()):
            $ label = _(p)
            $# quick hack to display images in diff
            $if (p in ["coverimage", "photograph"]) and (a[p] != b[p]):
                <tr>
                    <td class="diff-header-side" valign="top">$label</td>
                    <td class="diff-body" valign="top"><img width="180" src="$a[p]"/></td>
                    <td class="diff-body" valign="top"><img width="180" src="$b[p]"/></td>
                </tr> 
            $else:
                $:thingdiff(get_expected_type(a, p), label, a[p], b[p])
    </table>
       
    <div id="legend">
       <h3>$_("Legend"):</h3>
       <dl>
           <dt class="unmod"></dt><dd>$_("Unmodified")</dd>
           <dt class="add"></dt><dd>$_("Added")</dd>
           <dt class="rem"></dt><dd>$_("Removed")</dd>
           <dt class="mod"></dt><dd>$_("Modified")</dd>
       </dl>
    </div>

</div>