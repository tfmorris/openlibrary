$def with (input, results)

$def textfield(name, size=30):
    $if name in input:
        <input name="$name" value="$input[name]" size="$size">
    $else:
        <input name="$name" size="$size">

$ languages = (
$    ('eng', 'English'),
$    ('ger', 'German'),
$    ('spa', 'Spanish'),
$    ('rus', 'Russian'),
$    ('ita', 'Italian'),
$    ('chi', 'Chinese'),
$    ('ara', 'Arabic'),
$    ('jpn', 'Japanese'),
$    ('por', 'Portuguese'),
$ )

$def checkbox(name):
    $if name in input:
        <input name="$name" type="checkbox" value="true" checked>
    $else:
        <input name="$name" type="checkbox" value="true">

$def language_menu():
    <select name="language">
    <option value="">
    $for code, name in languages:
        <option value="$code">$name
    </select>

<body>
$ advanced = (
$    ('title', 'Title'),
$    ('author', 'Author'),
$    ('isbn', 'ISBN'),
$    ('publisher', 'Publisher'),
$    ('lccn', 'LCCN'),
$    ('oclc', 'OCLC'),
$    ('contributor', 'Contributor'),
$ )

<table><tr><td valign="top">
<h2>Simple</h2>
<form>
$:textfield('q')
<input type="submit" value="Search"><br>
$:checkbox('has_fulltext') just eBooks?

</form>
</td><td>
<h2>Advanced</h2>
<form>
<table>
$for name, label in advanced:
    <tr><td>$label</td><td>$:textfield(name)</td></tr> 
<tr><td>Language</td><td>$:language_menu()</td></tr> 
<tr><td></td><td>$:checkbox('has_fulltext') just eBooks?</td></tr> 
<tr><td></td><td>$:checkbox('fiction') just fiction?</td></tr> 
<tr><td></td><td><input type="submit" value="Search"></td>
</table>
</form>
</td></tr></table><p>
$if results:
    $:results
$else:
    OR <a href="?q=*:*">Search for all works</a>.